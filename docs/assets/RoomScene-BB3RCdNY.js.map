{"version":3,"mappings":"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","names":["RoomScene","BaseScene","app","__publicField","Container","skyGradient","Graphics","GameConfig","ground","leftWall","rightWall","ceiling","doorOpening","doorFrame","posterFrame","tierColor","tier","roomTitle","Text","controlsBackground","controlsText","deltaTime","speed","roomBounds","npcSpeed","interactionDistance","doorArea","playerInDoorArea","npcDistance","itemDistance","posterDistance","keyCode","text","dialogWidth","dialogHeight","dialogBg","dialogText","closeText","popupContainer","overlay","popupWidth","popupHeight","popup","title","instructions","maxLength","words","lines","currentLine","word","sceneManager","HallwayScene","__vitePreload","n","currentFloor","currentRoomNumber","HallwaySceneWithPlayerPosition"],"ignoreList":[],"sources":["../../src/scenes/RoomScene.ts"],"sourcesContent":["import { Application, Graphics, Text, Container } from 'pixi.js';\nimport { BaseScene } from '../core/BaseScene';\nimport { GameConfig } from '../config/GameConfig';\nimport { PatronManager } from '../utils/PatronManager';\nimport { Patron } from '../types/GameTypes';\n// Avoid circular import - import HallwayScene dynamically when needed\n\nexport class RoomScene extends BaseScene {\n  protected patronManager!: PatronManager;\n  protected floor!: number;\n  protected roomNumber!: number;\n  protected patron!: Patron;\n  \n  private roomContainer!: Container;\n  private npcSprite!: Graphics;\n  private playerSprite!: Graphics;\n  private itemSprite!: Graphics;\n  private posterSprite!: Graphics;\n  private dialogContainer!: Container;\n  \n  private playerPosition = { x: 50, y: 0 };\n  private npcPosition = { x: 400, y: 0 };\n  private npcDirection = 1; // 1 for right, -1 for left\n  private npcPaceMin = 300;\n  private npcPaceMax = 500;\n  \n  // Side-scroller specific properties\n  private groundLevel = 0;\n  private platformHeight = 20;\n  \n  private isShowingDialog = false;\n  private isNearNPC = false;\n  private isNearItem = false;\n  private isNearPoster = false;\n  private isNearDoor = false;\n  private exitPopup?: Container;\n  \n  private interactionPrompt!: Text;\n\n  constructor(app: Application) {\n    super(app);\n  }\n\n  async enter(): Promise<void> {\n    // Validate that required data was passed\n    if (!this.patronManager || this.floor === undefined || this.roomNumber === undefined) {\n      console.error('RoomScene: Missing required data');\n      return;\n    }\n    \n    this.patron = this.patronManager.getPatronInRoom(this.floor, this.roomNumber)!;\n    if (!this.patron) {\n      console.error(`No patron found in room ${this.floor}-${this.roomNumber}`);\n      return;\n    }\n    \n    this.createRoomLayout();\n    this.createRoomElements();\n    this.createPlayer();\n    this.createNPC();\n    this.createUI();\n    this.positionElements();\n    \n    console.log(`ðŸ  Entered ${this.patron.name}'s room on floor ${this.floor}`);\n  }\n\n  private createRoomLayout(): void {\n    this.roomContainer = new Container();\n    \n    // Calculate ground level for side-scroller\n    this.groundLevel = this.layout.roomHeight - this.platformHeight - 20;\n    \n    // Sky/background gradient\n    const skyGradient = new Graphics();\n    skyGradient.rect(0, 0, this.layout.roomWidth, this.layout.roomHeight * 0.7)\n      .fill(GameConfig.PLACEHOLDER_COLORS.BACKGROUND);\n    \n    // Ground/floor platform\n    const ground = new Graphics();\n    ground.rect(0, this.groundLevel, this.layout.roomWidth, this.platformHeight)\n      .fill(GameConfig.PLACEHOLDER_COLORS.FLOOR);\n    \n    // Side walls (left and right)\n    const leftWall = new Graphics();\n    leftWall.rect(0, 0, 20, this.layout.roomHeight)\n      .fill(GameConfig.PLACEHOLDER_COLORS.WALL);\n    \n    const rightWall = new Graphics();\n    rightWall.rect(this.layout.roomWidth - 20, 0, 20, this.layout.roomHeight)\n      .fill(GameConfig.PLACEHOLDER_COLORS.WALL);\n    \n    // Ceiling\n    const ceiling = new Graphics();\n    ceiling.rect(0, 0, this.layout.roomWidth, 20)\n      .fill(GameConfig.PLACEHOLDER_COLORS.WALL);\n    \n    // Door opening (left side, ground level)\n    const doorOpening = new Graphics();\n    doorOpening.rect(0, this.groundLevel - 60, 20, 60)\n      .fill(GameConfig.PLACEHOLDER_COLORS.BACKGROUND);\n    \n    // Door frame\n    const doorFrame = new Graphics();\n    doorFrame.rect(5, this.groundLevel - 65, 10, 70)\n      .fill(GameConfig.PLACEHOLDER_COLORS.DOOR);\n    \n    this.roomContainer.addChild(skyGradient, ground, leftWall, rightWall, ceiling, doorOpening, doorFrame);\n    \n    // Center the room on screen\n    this.roomContainer.x = (this.layout.screenWidth - this.layout.roomWidth) / 2;\n    this.roomContainer.y = (this.layout.screenHeight - this.layout.roomHeight) / 2;\n    \n    this.container.addChild(this.roomContainer);\n  }\n\n  private createRoomElements(): void {\n    // Create item placeholder (on ground, left side)\n    this.itemSprite = new Graphics()\n      .rect(0, 0, this.layout.itemSize, this.layout.itemSize)\n      .fill(GameConfig.PLACEHOLDER_COLORS.ITEM);\n    \n    // Create poster placeholder (on back wall, upper area)\n    this.posterSprite = new Graphics()\n      .rect(0, 0, this.layout.posterWidth, this.layout.posterHeight)\n      .fill(GameConfig.PLACEHOLDER_COLORS.POSTER);\n      \n    // Add a frame around poster\n    const posterFrame = new Graphics()\n      .rect(-this.layout.posterFrameBorder, -this.layout.posterFrameBorder, \n            this.layout.posterWidth + (this.layout.posterFrameBorder * 2), \n            this.layout.posterHeight + (this.layout.posterFrameBorder * 2))\n      .stroke({ width: 2, color: 0x8b4513 });\n    \n    this.posterSprite.addChild(posterFrame);\n    \n    this.roomContainer.addChild(this.itemSprite, this.posterSprite);\n  }\n\n  private createPlayer(): void {\n    this.playerSprite = new Graphics()\n      .rect(0, 0, this.layout.playerWidth, this.layout.playerHeight)\n      .fill(GameConfig.UI_COLORS.ACCENT);\n      \n    // Add simple face\n    this.playerSprite\n      .circle(this.layout.playerWidth / 2, this.layout.characterFaceY, this.layout.characterFaceRadius)\n      .fill(0x000000);\n    \n    this.roomContainer.addChild(this.playerSprite);\n  }\n\n  private createNPC(): void {\n    this.npcSprite = new Graphics()\n      .rect(0, 0, this.layout.npcWidth, this.layout.npcHeight)\n      .fill(GameConfig.PLACEHOLDER_COLORS.NPC);\n      \n    // Add simple face and features based on tier\n    this.npcSprite\n      .circle(this.layout.npcWidth / 2, this.layout.characterFaceY, this.layout.characterFaceRadius)\n      .fill(0x000000);\n    \n    // Add tier indicator (simple colored dot)\n    const tierColor = this.getTierColor(this.patron.tier);\n    this.npcSprite\n      .circle(this.layout.npcWidth / 2, this.layout.npcHeight - this.layout.tierIndicatorOffset, this.layout.tierIndicatorRadius)\n      .fill(tierColor);\n    \n    this.roomContainer.addChild(this.npcSprite);\n  }\n\n  private getTierColor(tier?: string): number {\n    switch (tier) {\n      case 'bronze': return 0xcd7f32;\n      case 'silver': return 0xc0c0c0;\n      case 'gold': return 0xffd700;\n      case 'diamond': return 0xb9f2ff;\n      default: return 0xffffff;\n    }\n  }\n\n  private createUI(): void {\n    // Room title\n    const roomTitle = new Text({\n      text: `${this.patron.name}'s Workshop`,\n      style: {\n        fontFamily: GameConfig.DEFAULT_FONT_FAMILY,\n        fontSize: this.layout.getFontSize(GameConfig.FONT_SIZES.SUBTITLE),\n        fill: GameConfig.UI_COLORS.TEXT,\n        align: 'center',\n        fontWeight: 'bold'\n      }\n    });\n    roomTitle.anchor.set(0.5);\n    roomTitle.x = this.layout.centerX();\n    roomTitle.y = this.layout.margin;\n    \n    // Controls with background\n    const controlsBackground = new Graphics()\n      .rect(0, 0, this.layout.roomControlsBackgroundWidth, this.layout.roomControlsBackgroundHeight)\n      .fill(0x000000);\n    \n    const controlsText = new Text({\n      text: 'Use â† â†’ to move, SPACE to interact, ESC to leave',\n      style: {\n        fontFamily: GameConfig.DEFAULT_FONT_FAMILY,\n        fontSize: this.layout.getFontSize(GameConfig.FONT_SIZES.SMALL),\n        fill: 0xffffff,\n        align: 'center'\n      }\n    });\n    controlsBackground.x = this.layout.centerX() - (this.layout.roomControlsBackgroundWidth / 2);\n    controlsBackground.y = this.layout.screenHeight - this.layout.margin - this.layout.roomControlsBackgroundHeight;\n    \n    controlsText.anchor.set(0.5);\n    controlsText.x = this.layout.centerX();\n    controlsText.y = this.layout.screenHeight - this.layout.margin - (this.layout.roomControlsBackgroundHeight / 2);\n    \n    // Interaction prompt\n    this.interactionPrompt = new Text({\n      text: 'Press SPACE to interact',\n      style: {\n        fontFamily: GameConfig.DEFAULT_FONT_FAMILY,\n        fontSize: this.layout.getFontSize(GameConfig.FONT_SIZES.UI),\n        fill: GameConfig.UI_COLORS.ACCENT,\n        align: 'center',\n        fontWeight: 'bold'\n      }\n    });\n    this.interactionPrompt.anchor.set(0.5);\n    this.interactionPrompt.x = this.layout.centerX();\n    this.interactionPrompt.y = this.layout.getFontSize(80);\n    this.interactionPrompt.visible = false;\n    \n    this.container.addChild(roomTitle, controlsBackground, controlsText, this.interactionPrompt);\n  }\n\n  private positionElements(): void {\n    // Position player at entrance (left side, on ground)\n    this.playerPosition.x = 40;\n    this.playerPosition.y = this.groundLevel - this.layout.playerHeight;\n    \n    // Position NPC in center area, on ground\n    this.npcPosition.x = this.layout.roomWidth * 0.5;\n    this.npcPosition.y = this.groundLevel - this.layout.npcHeight;\n    \n    // Update NPC pacing boundaries (on ground level)\n    this.npcPaceMin = this.layout.roomWidth * 0.3;\n    this.npcPaceMax = this.layout.roomWidth * 0.7;\n    \n    // Position item on ground, left-center area\n    this.itemSprite.x = this.layout.roomWidth * 0.25;\n    this.itemSprite.y = this.groundLevel - this.layout.itemSize;\n    \n    // Position poster on back wall, upper area\n    this.posterSprite.x = this.layout.roomWidth * 0.75 - this.layout.posterWidth / 2;\n    this.posterSprite.y = this.layout.roomHeight * 0.2;\n    \n    this.updateSpritePositions();\n  }\n\n  private updateSpritePositions(): void {\n    this.playerSprite.x = this.playerPosition.x;\n    this.playerSprite.y = this.playerPosition.y;\n    \n    this.npcSprite.x = this.npcPosition.x;\n    this.npcSprite.y = this.npcPosition.y;\n  }\n\n  update(deltaTime: number): void {\n    if (!this.isShowingDialog) {\n      this.handleMovement(deltaTime);\n      this.updateNPCMovement(deltaTime);\n    }\n    this.checkInteractions();\n  }\n\n  private handleMovement(deltaTime: number): void {\n    const speed = this.layout.playerSpeed * (deltaTime / 60);\n    const roomBounds = {\n      left: this.layout.roomSideMargin,\n      right: this.layout.roomWidth - this.layout.playerWidth - this.layout.roomSideMargin\n    };\n    \n    if (this.isKeyPressed('ArrowLeft')) {\n      this.playerPosition.x = Math.max(roomBounds.left, this.playerPosition.x - speed);\n    }\n    \n    if (this.isKeyPressed('ArrowRight')) {\n      this.playerPosition.x = Math.min(roomBounds.right, this.playerPosition.x + speed);\n    }\n    \n    // Keep player on ground level\n    this.playerPosition.y = this.groundLevel - this.layout.playerHeight;\n    \n    this.updateSpritePositions();\n  }\n\n  private updateNPCMovement(deltaTime: number): void {\n    const npcSpeed = this.layout.npcSpeed * (deltaTime / 60);\n    \n    // Move NPC back and forth in their pace area (on ground)\n    this.npcPosition.x += npcSpeed * this.npcDirection;\n    \n    // Check bounds and reverse direction\n    if (this.npcPosition.x >= this.npcPaceMax) {\n      this.npcDirection = -1;\n      this.npcPosition.x = this.npcPaceMax;\n    } else if (this.npcPosition.x <= this.npcPaceMin) {\n      this.npcDirection = 1;\n      this.npcPosition.x = this.npcPaceMin;\n    }\n    \n    // Keep NPC on ground level  \n    this.npcPosition.y = this.groundLevel - this.layout.npcHeight;\n    \n    this.updateSpritePositions();\n  }\n\n  private checkInteractions(): void {\n    const interactionDistance = this.layout.interactionDistance;\n    \n    // Check door collision (left side of room)\n    const doorArea = { x: 0, y: this.groundLevel - 60, width: 25, height: 60 };\n    const playerInDoorArea = this.playerPosition.x >= doorArea.x && \n                            this.playerPosition.x <= doorArea.x + doorArea.width &&\n                            this.playerPosition.y + this.layout.playerHeight >= doorArea.y &&\n                            this.playerPosition.y <= doorArea.y + doorArea.height;\n    \n    this.isNearDoor = playerInDoorArea;\n    \n    // Check NPC interaction\n    const npcDistance = Math.abs(this.playerPosition.x - this.npcPosition.x);\n    this.isNearNPC = npcDistance < interactionDistance;\n    \n    // Check item interaction\n    const itemDistance = Math.abs(this.playerPosition.x - this.itemSprite.x);\n    this.isNearItem = itemDistance < interactionDistance;\n    \n    // Check poster interaction  \n    const posterDistance = Math.abs(this.playerPosition.x - this.posterSprite.x);\n    this.isNearPoster = posterDistance < interactionDistance;\n    \n    // Update interaction prompt (door takes priority)\n    if (this.isNearDoor && !this.exitPopup) {\n      this.interactionPrompt.visible = true;\n      this.interactionPrompt.text = 'Press SPACE to leave room';\n    } else if (this.isNearNPC || this.isNearItem || this.isNearPoster) {\n      this.interactionPrompt.visible = true;\n      \n      if (this.isNearNPC) {\n        this.interactionPrompt.text = `Press SPACE to talk to ${this.patron.name}`;\n      } else if (this.isNearItem) {\n        this.interactionPrompt.text = 'Press SPACE to examine item';\n      } else if (this.isNearPoster) {\n        this.interactionPrompt.text = 'Press SPACE to view poster';\n      }\n    } else {\n      this.interactionPrompt.visible = false;\n    }\n  }\n\n  handleKeyDown(keyCode: string): void {\n    super.handleKeyDown(keyCode);\n    \n    // Handle exit popup\n    if (this.exitPopup) {\n      if (keyCode === 'Enter' || keyCode === 'Space') {\n        this.confirmExit();\n        return;\n      } else if (keyCode === 'Escape') {\n        this.cancelExit();\n        return;\n      }\n    }\n    \n    switch (keyCode) {\n      case 'Space':\n        this.handleInteraction();\n        break;\n      case 'Escape':\n        if (this.isShowingDialog) {\n          this.hideDialog();\n        } else {\n          this.exitRoom();\n        }\n        break;\n    }\n  }\n\n  private handleInteraction(): void {\n    if (this.isShowingDialog) {\n      this.hideDialog();\n      return;\n    }\n    \n    if (this.isNearDoor) {\n      this.showExitPopup();\n    } else if (this.isNearNPC) {\n      this.showDialog(this.patron.dialogText);\n    } else if (this.isNearItem) {\n      this.showDialog(`This is ${this.patron.name}'s special item. It holds great meaning to them!`);\n    } else if (this.isNearPoster) {\n      this.showDialog(`A beautiful poster chosen by ${this.patron.name}. It reflects their personality and interests.`);\n    }\n  }\n\n  private showDialog(text: string): void {\n    this.isShowingDialog = true;\n    \n    // Create dialog container\n    this.dialogContainer = new Container();\n    \n    const dialogWidth = this.layout.screenWidth * 0.8;\n    const dialogHeight = this.layout.screenHeight * 0.2;\n    \n    // Dialog background\n    const dialogBg = new Graphics()\n      .roundRect(0, 0, dialogWidth, dialogHeight, 10)\n      .fill(0x000000, 0.8)\n      .stroke({ width: 2, color: GameConfig.UI_COLORS.PRIMARY });\n    \n    // Dialog text\n    const dialogText = new Text({\n      text: this.wrapText(text, Math.floor(dialogWidth / this.layout.getFontSize(10))), \n      style: {\n        fontFamily: GameConfig.DEFAULT_FONT_FAMILY,\n        fontSize: this.layout.getFontSize(GameConfig.FONT_SIZES.BODY),\n        fill: GameConfig.UI_COLORS.TEXT,\n        align: 'left',\n        wordWrap: true,\n        wordWrapWidth: dialogWidth - 40\n      }\n    });\n    dialogText.x = 20;\n    dialogText.y = 20;\n    \n    // Close instruction\n    const closeText = new Text({\n      text: 'Press SPACE or ESC to close',\n      style: {\n        fontFamily: GameConfig.DEFAULT_FONT_FAMILY,\n        fontSize: this.layout.getFontSize(GameConfig.FONT_SIZES.SMALL),\n        fill: GameConfig.UI_COLORS.SECONDARY,\n        align: 'right'\n      }\n    });\n    closeText.anchor.set(1, 1);\n    closeText.x = dialogWidth - 20;\n    closeText.y = dialogHeight - 10;\n    \n    this.dialogContainer.addChild(dialogBg, dialogText, closeText);\n    \n    // Center dialog on screen\n    this.dialogContainer.x = this.layout.centerX(dialogWidth);\n    this.dialogContainer.y = this.layout.screenHeight - dialogHeight - this.layout.margin;\n    \n    this.container.addChild(this.dialogContainer);\n  }\n\n  private hideDialog(): void {\n    if (this.dialogContainer) {\n      this.container.removeChild(this.dialogContainer);\n      this.dialogContainer.destroy();\n    }\n    this.isShowingDialog = false;\n  }\n  \n  private showExitPopup(): void {\n    const popupContainer = new Container();\n    \n    // Semi-transparent background\n    const overlay = new Graphics()\n      .rect(0, 0, this.layout.screenWidth, this.layout.screenHeight)\n      .fill(0x000000, 0.7);\n    \n    // Popup background\n    const popupWidth = 400 * this.layout.scale;\n    const popupHeight = 150 * this.layout.scale;\n    const popup = new Graphics()\n      .rect(0, 0, popupWidth, popupHeight)\n      .fill(0x2c3e50)\n      .stroke({ width: 3, color: GameConfig.UI_COLORS.ACCENT });\n    \n    popup.x = this.layout.centerX() - popupWidth / 2;\n    popup.y = this.layout.centerY() - popupHeight / 2;\n    \n    // Title\n    const title = new Text({\n      text: 'Leave Room?',\n      style: {\n        fontFamily: GameConfig.DEFAULT_FONT_FAMILY,\n        fontSize: this.layout.getFontSize(GameConfig.FONT_SIZES.SUBTITLE),\n        fill: GameConfig.UI_COLORS.TEXT,\n        align: 'center',\n        fontWeight: 'bold'\n      }\n    });\n    title.anchor.set(0.5);\n    title.x = popupWidth / 2;\n    title.y = 40 * this.layout.scale;\n    \n    // Instructions\n    const instructions = new Text({\n      text: 'Press ENTER to return to hallway, ESC to stay',\n      style: {\n        fontFamily: GameConfig.DEFAULT_FONT_FAMILY,\n        fontSize: this.layout.getFontSize(GameConfig.FONT_SIZES.SMALL),\n        fill: GameConfig.UI_COLORS.SECONDARY,\n        align: 'center'\n      }\n    });\n    instructions.anchor.set(0.5);\n    instructions.x = popupWidth / 2;\n    instructions.y = 90 * this.layout.scale;\n    \n    popup.addChild(title, instructions);\n    popupContainer.addChild(overlay, popup);\n    this.container.addChild(popupContainer);\n    \n    this.exitPopup = popupContainer;\n  }\n  \n  private confirmExit(): void {\n    if (this.exitPopup) {\n      this.container.removeChild(this.exitPopup);\n      this.exitPopup = undefined;\n    }\n    this.exitRoom();\n  }\n  \n  private cancelExit(): void {\n    if (this.exitPopup) {\n      this.container.removeChild(this.exitPopup);\n      this.exitPopup = undefined;\n    }\n  }\n\n  private wrapText(text: string, maxLength: number): string {\n    // Simple text wrapping\n    const words = text.split(' ');\n    const lines: string[] = [];\n    let currentLine = '';\n    \n    for (const word of words) {\n      if ((currentLine + word).length <= maxLength) {\n        currentLine += (currentLine ? ' ' : '') + word;\n      } else {\n        if (currentLine) lines.push(currentLine);\n        currentLine = word;\n      }\n    }\n    \n    if (currentLine) lines.push(currentLine);\n    return lines.join('\\n');\n  }\n\n  private async exitRoom(): Promise<void> {\n    console.log(`ðŸšª Leaving ${this.patron.name}'s workshop`);\n    \n    const sceneManager = (this.app as any).sceneManager;\n    if (sceneManager) {\n      // Import HallwayScene dynamically to avoid circular dependency\n      const { HallwayScene } = await import('./HallwayScene');\n      \n      // Capture the current room's floor and roomNumber\n      const currentFloor = this.floor;\n      const currentRoomNumber = this.roomNumber;\n      \n      // Create HallwayScene with player positioned at the room door\n      const HallwaySceneWithPlayerPosition = class extends HallwayScene {\n        constructor(app: Application) {\n          super(app);\n          (this as any).currentFloor = currentFloor;\n          (this as any).returnFromRoom = currentRoomNumber;\n        }\n      };\n      \n      await sceneManager.switchTo(HallwaySceneWithPlayerPosition);\n    }\n  }\n\n  onResize(): void {\n    // Recalculate ground level\n    this.groundLevel = this.layout.roomHeight - this.platformHeight - 20;\n    \n    // Clear and recreate the room layout\n    this.container.removeChildren();\n    this.createRoomLayout();\n    this.createRoomElements();\n    this.createPlayer();\n    this.createNPC();\n    this.createUI();\n    this.positionElements();\n    \n    // Close any open dialog\n    if (this.isShowingDialog) {\n      this.hideDialog();\n    }\n  }\n}"],"file":"assets/RoomScene-BB3RCdNY.js"}