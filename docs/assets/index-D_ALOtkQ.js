const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./RoomScene-BB3RCdNY.js","./pixi-Cnp5aGhx.js"])))=>i.map(i=>d[i]);
var b=Object.defineProperty;var A=(m,n,t)=>n in m?b(m,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[n]=t;var l=(m,n,t)=>A(m,typeof n!="symbol"?n+"":n,t);import{C as f,G as g,T as p,_ as L,b as P}from"./pixi-Cnp5aGhx.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&e(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function e(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();class D{constructor(n){l(this,"app");l(this,"currentScene",null);l(this,"isTransitioning",!1);this.app=n}async switchTo(n){if(!this.isTransitioning){this.isTransitioning=!0;try{this.currentScene&&(await this.currentScene.exit(),this.app.stage.removeChild(this.currentScene.container),this.currentScene.destroy());const t=new n(this.app);this.currentScene=t,this.app.stage.addChild(t.container),await t.enter()}catch(t){}finally{this.isTransitioning=!1}}}handleKeyDown(n){this.currentScene&&this.currentScene.handleKeyDown&&this.currentScene.handleKeyDown(n)}handleKeyUp(n){this.currentScene&&this.currentScene.handleKeyUp&&this.currentScene.handleKeyUp(n)}setupUpdateLoop(){this.app.ticker.add(n=>{const t=n.deltaTime;this.currentScene&&this.currentScene.update&&this.currentScene.update(t)})}getCurrentScene(){return this.currentScene}}const o={SCREEN_WIDTH:1200,SCREEN_HEIGHT:800,ROOM_WIDTH:800,ROOM_HEIGHT:450,BACKGROUND_COLOR:1710638,ROOMS_PER_FLOOR:3,MAX_FLOORS:5,PLAYER_SPEED:150,PLAYER_WIDTH:32,PLAYER_HEIGHT:90,NPC_SPEED:50,NPC_WIDTH:32,NPC_HEIGHT:48,INTERACTION_DISTANCE:50,UI_COLORS:{PRIMARY:4886754,SECONDARY:8087790,ACCENT:16766720,TEXT:16777215,BUTTON:2899536,BUTTON_HOVER:3426654,SUCCESS:2600544,WARNING:15965202},PLACEHOLDER_COLORS:{NPC:16739179,ITEM:5164484,POSTER:4569041,BACKGROUND:9883316,DOOR:7101671,WALL:9807270,FLOOR:9268835},FADE_DURATION:1e3,DEFAULT_FONT_FAMILY:"Arial, sans-serif",FONT_SIZES:{TITLE:48,SUBTITLE:24,BODY:18,SMALL:14,UI:16}},T=class T{constructor(){l(this,"dimensions");l(this,"animatedDimensions");l(this,"baseWidth",o.SCREEN_WIDTH);l(this,"baseHeight",o.SCREEN_HEIGHT);l(this,"animationId",null);l(this,"bounceSettings",{duration:300,elasticity:.3,damping:.8});l(this,"resizeCallbacks",[]);this.dimensions=this.calculateDimensions(),this.animatedDimensions={...this.dimensions,isAnimating:!1},this.setupResizeListener()}static getInstance(){return T.instance||(T.instance=new T),T.instance}calculateDimensions(){const n=window.innerWidth,t=window.innerHeight,e=n/this.baseWidth,i=t/this.baseHeight,s=Math.min(e,i,1.2),a=this.baseWidth*s,h=this.baseHeight*s,c=o.ROOM_WIDTH*s,r=o.ROOM_HEIGHT*s;return{screenWidth:a,screenHeight:h,roomWidth:c,roomHeight:r,scale:s}}setupResizeListener(){window.addEventListener("resize",()=>{const n=this.calculateDimensions();this.animateToNewDimensions(n)})}animateToNewDimensions(n){this.animationId&&cancelAnimationFrame(this.animationId);const t={...this.animatedDimensions},e=performance.now();this.animatedDimensions.isAnimating=!0;const i=s=>{const a=s-e,h=Math.min(a/this.bounceSettings.duration,1),c=u=>{if(u===0||u===1)return u;const d=.3,y=d/(2*Math.PI)*Math.asin(1);return-(Math.pow(2,10*(u-1))*Math.sin((u-1-y)*(2*Math.PI)/d))},r=h<1?1+c(h):1;this.animatedDimensions.screenWidth=t.screenWidth+(n.screenWidth-t.screenWidth)*r,this.animatedDimensions.screenHeight=t.screenHeight+(n.screenHeight-t.screenHeight)*r,this.animatedDimensions.roomWidth=t.roomWidth+(n.roomWidth-t.roomWidth)*r,this.animatedDimensions.roomHeight=t.roomHeight+(n.roomHeight-t.roomHeight)*r,this.animatedDimensions.scale=t.scale+(n.scale-t.scale)*r,this.notifyResize(),h<1?this.animationId=requestAnimationFrame(i):(this.dimensions=n,this.animatedDimensions={...n,isAnimating:!1},this.animationId=null,this.notifyResize())};this.animationId=requestAnimationFrame(i)}onResize(n){this.resizeCallbacks.push(n)}notifyResize(){this.resizeCallbacks.forEach(n=>n(this.dimensions))}getDimensions(){return{...this.animatedDimensions}}get screenWidth(){return this.animatedDimensions.screenWidth}get screenHeight(){return this.animatedDimensions.screenHeight}get roomWidth(){return this.animatedDimensions.roomWidth}get roomHeight(){return this.animatedDimensions.roomHeight}get scale(){return this.animatedDimensions.scale}get playerWidth(){return o.PLAYER_WIDTH*this.scale}get playerHeight(){return o.PLAYER_HEIGHT*this.scale}get npcWidth(){return o.NPC_WIDTH*this.scale}get npcHeight(){return o.NPC_HEIGHT*this.scale}get interactionDistance(){return o.INTERACTION_DISTANCE*this.scale}get playerSpeed(){return o.PLAYER_SPEED*this.scale}get npcSpeed(){return o.NPC_SPEED*this.scale}getFontSize(n){return Math.max(12,n*this.scale)}centerX(n=0){return(this.screenWidth-n)/2}centerY(n=0){return(this.screenHeight-n)/2}getButtonSize(){return{width:150*this.scale,height:50*this.scale}}get margin(){return 20*this.scale}get doorWidth(){return 80*this.scale}get doorHeight(){return 120*this.scale}get doorHandleOffset(){return 15*this.scale}get doorHandleRadius(){return 3*this.scale}get roomLabelOffset(){return 20*this.scale}get occupancyLabelOffset(){return 15*this.scale}get elevatorWidth(){return 100*this.scale}get elevatorHeight(){return 150*this.scale}get elevatorButtonRadius(){return 15*this.scale}get elevatorUpButtonY(){return 30*this.scale}get elevatorDownButtonY(){return 60*this.scale}get elevatorFloorIndicatorY(){return 90*this.scale}get elevatorLabelY(){return 120*this.scale}get elevatorMargin(){return 50*this.scale}get hallwayControlsBackgroundWidth(){return 300*this.scale}get hallwayControlsBackgroundHeight(){return 30*this.scale}get roomControlsBackgroundWidth(){return 400*this.scale}get roomControlsBackgroundHeight(){return 30*this.scale}get controlsBackgroundPadding(){return 5*this.scale}get playerStartX(){return 100*this.scale}get playerGroundOffset(){return 10*this.scale}get itemSize(){return 30*this.scale}get posterWidth(){return 60*this.scale}get posterHeight(){return 80*this.scale}get posterFrameBorder(){return 3*this.scale}get characterFaceY(){return 12*this.scale}get characterFaceRadius(){return 3*this.scale}get tierIndicatorOffset(){return 8*this.scale}get tierIndicatorRadius(){return 4*this.scale}get hallwaySideMargin(){return 50*this.scale}get roomSideMargin(){return 25*this.scale}get ceilingHeight(){return 80*this.scale}};l(T,"instance");let I=T;class w{constructor(n){l(this,"app");l(this,"container");l(this,"keysPressed",new Set);l(this,"layout");this.app=n,this.container=new f,this.layout=I.getInstance()}exit(){}update(n){}handleKeyDown(n){this.keysPressed.add(n)}handleKeyUp(n){this.keysPressed.delete(n)}isKeyPressed(n){return this.keysPressed.has(n)}destroy(){this.container.destroy({children:!0}),this.keysPressed.clear()}createBackground(n=0){const t=new g().rect(0,0,this.layout.screenWidth,this.layout.screenHeight).fill(n);this.container.addChild(t)}}class B extends w{constructor(t){super(t);l(this,"backButton")}async enter(){this.createBackground(o.BACKGROUND_COLOR),this.createContent(),this.createBackButton(),this.setupInteractivity()}createContent(){const t=new p({text:"About Interactive Credits",style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.TITLE),fill:o.UI_COLORS.TEXT,align:"center",fontWeight:"bold"}});t.anchor.set(.5),t.x=this.layout.centerX(),t.y=this.layout.screenHeight*.15;const e=["Welcome to our Interactive Credits system!","","Inspired by Whittier, Alaska - a unique town where everyone lives","under one roof - this experience showcases our amazing patrons",'as residents of "The Workshop."',"","Each patron has their own room with:","• Personal items and decorations","• A unique story to tell","• Custom artwork and posters","","Navigate through the building, meet our supporters,","and learn about the incredible people who make our work possible.","","Use the arrow keys to move and SPACE to interact!"],i=this.layout.getFontSize(o.FONT_SIZES.BODY)*1.3,s=this.layout.screenHeight*.25;e.forEach((h,c)=>{const r=new p({text:h,style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.BODY),fill:o.UI_COLORS.TEXT,align:"center"}});r.anchor.set(.5),r.x=this.layout.centerX(),r.y=s+c*i,this.container.addChild(r)});const a=new p({text:"Thank you to our supporters!",style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.SMALL),fill:o.UI_COLORS.SECONDARY,align:"center",fontStyle:"italic"}});a.anchor.set(.5),a.x=this.layout.centerX(),a.y=this.layout.screenHeight*.85,this.container.addChild(t,a)}createBackButton(){const t=new f,e=this.layout.getButtonSize(),i=new g().roundRect(0,0,e.width*.8,e.height*.8,8).fill(o.UI_COLORS.BUTTON),s=new p({text:"BACK",style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.UI),fill:o.UI_COLORS.TEXT,align:"center",fontWeight:"bold"}});s.anchor.set(.5),s.x=e.width*.8/2,s.y=e.height*.8/2,t.addChild(i,s),t.x=this.layout.centerX(e.width*.8),t.y=this.layout.screenHeight*.92-e.height*.8,t.eventMode="static",t.cursor="pointer",t.background=i,t.text=s,this.backButton=t,this.container.addChild(this.backButton)}setupInteractivity(){this.backButton.on("pointerenter",()=>{this.updateButtonAppearance(!0)}),this.backButton.on("pointerleave",()=>{this.updateButtonAppearance(!1)}),this.backButton.on("pointerdown",()=>{this.goBack()})}updateButtonAppearance(t){const e=this.backButton.background,i=t?o.UI_COLORS.BUTTON_HOVER:o.UI_COLORS.BUTTON,s=this.layout.getButtonSize();e.clear(),e.roundRect(0,0,s.width*.8,s.height*.8,8).fill(i)}onResize(){this.container.removeChildren(),this.createBackground(o.BACKGROUND_COLOR),this.createContent(),this.createBackButton(),this.setupInteractivity()}handleKeyDown(t){switch(super.handleKeyDown(t),t){case"Escape":case"Backspace":case"Enter":this.goBack();break}}async goBack(){const t=this.app.sceneManager;if(t){const{StartScene:e}=await L(async()=>{const{StartScene:i}=await Promise.resolve().then(()=>v);return{StartScene:i}},void 0,import.meta.url);await t.switchTo(e)}}}const x=[{id:"patron_001",name:"Dennis Ramirez",dialogText:"Thanks for supporting our work!",tier:"gold",joinDate:"2024-01-15",specialNotes:"First patron ever!"},{id:"patron_002",name:"Charlie Mackin",dialogText:"Thanks for supporting our work!",tier:"silver",joinDate:"2024-02-03"},{id:"patron_003",name:"Harry",dialogText:"Movies!",tier:"bronze",joinDate:"2024-02-10"},{id:"patron_004",name:"Kevin",dialogText:"I'm Kevin!",tier:"diamond",floor:1,roomNumber:1,joinDate:"2024-01-20"}],M={patrons:x};class H{constructor(){l(this,"patrons",[]);l(this,"building",{floors:[]});this.loadPatrons(),this.generateBuilding()}loadPatrons(){this.patrons=M.patrons}generateBuilding(){this.building.floors=[];const n=this.patrons.filter(r=>r.floor!==void 0&&r.roomNumber!==void 0),t=this.patrons.filter(r=>r.floor===void 0||r.roomNumber===void 0),e=n.reduce((r,u)=>Math.max(r,u.floor||0),0),s=this.patrons.length,a=Math.max(Math.ceil(s/o.ROOMS_PER_FLOOR),e,1);for(let r=1;r<=Math.min(a,o.MAX_FLOORS);r++){const u={floorNumber:r,rooms:[]};for(let d=1;d<=o.ROOMS_PER_FLOOR;d++){const y={roomNumber:d,patron:null,isEmpty:!0};u.rooms.push(y)}this.building.floors.push(u)}for(const r of n)if(r.floor&&r.roomNumber){const u=this.building.floors.find(d=>d.floorNumber===r.floor);if(u){const d=u.rooms.find(y=>y.roomNumber===r.roomNumber);d&&d.isEmpty&&(d.patron=r,d.isEmpty=!1)}}let h=0,c=0;for(const r of t){let u=!1;for(;h<this.building.floors.length&&!u;){const d=this.building.floors[h];for(;c<d.rooms.length&&!u;){const y=d.rooms[c];y.isEmpty&&(y.patron=r,y.isEmpty=!1,u=!0),c++}u||(h++,c=0)}}}getPatrons(){return[...this.patrons]}getBuilding(){return this.building}getPatronById(n){return this.patrons.find(t=>t.id===n)}getPatronInRoom(n,t){const e=this.building.floors.find(s=>s.floorNumber===n);if(!e)return null;const i=e.rooms.find(s=>s.roomNumber===t);return i?i.patron:null}getFloorCount(){return this.building.floors.length}getRoomCount(n){const t=this.building.floors.find(e=>e.floorNumber===n);return t?t.rooms.length:0}isRoomEmpty(n,t){const e=this.building.floors.find(s=>s.floorNumber===n);if(!e)return!0;const i=e.rooms.find(s=>s.roomNumber===t);return i?i.isEmpty:!0}getAllOccupiedRooms(){const n=[];for(const t of this.building.floors)for(const e of t.rooms)!e.isEmpty&&e.patron&&n.push({floor:t.floorNumber,roomNumber:e.roomNumber});return n}}class E extends w{constructor(t){super(t);l(this,"patronManager");l(this,"currentFloor",1);l(this,"playerSprite");l(this,"playerPosition",{x:100,y:0});l(this,"playerSpeed",o.PLAYER_SPEED);l(this,"returnFromRoom");l(this,"selectedFloorInPopup",1);l(this,"doors",[]);l(this,"hallwayContainer");l(this,"uiContainer");l(this,"interactionPrompt");l(this,"nearDoorIndex",-1);l(this,"elevatorButton");l(this,"isNearElevator",!1);this.patronManager=new H}async enter(){this.playerSpeed=this.layout.playerSpeed,this.createBackground(o.PLACEHOLDER_COLORS.FLOOR),this.createHallwayLayout(),this.createDoors(),this.createElevator(),this.createPlayer(),this.createUI(),this.positionPlayer()}createHallwayLayout(){this.hallwayContainer=new f;const t=new g().rect(0,0,this.layout.screenWidth,this.layout.screenHeight).fill(o.PLACEHOLDER_COLORS.FLOOR),e=new g().rect(0,0,this.layout.screenWidth,this.layout.ceilingHeight).fill(o.PLACEHOLDER_COLORS.WALL);this.hallwayContainer.addChild(t,e),this.container.addChild(this.hallwayContainer)}createPlayer(){this.playerSprite=new g,this.updatePlayerSprite(),this.container.addChild(this.playerSprite)}updatePlayerSprite(){this.playerSprite.clear(),this.playerSprite.rect(0,0,this.layout.playerWidth,this.layout.playerHeight).fill(o.UI_COLORS.ACCENT),this.playerSprite.circle(this.layout.playerWidth/2,this.layout.characterFaceY,this.layout.characterFaceRadius).fill(0)}createDoors(){this.doors=[];const t=this.layout.doorWidth,e=this.layout.doorHeight,i=this.layout.screenWidth/(o.ROOMS_PER_FLOOR+1);for(let s=0;s<o.ROOMS_PER_FLOOR;s++){const a=new f,h=s+1,c=new g().rect(0,0,t,e).fill(o.PLACEHOLDER_COLORS.DOOR),r=new g().circle(t-this.layout.doorHandleOffset,e/2,this.layout.doorHandleRadius).fill(o.UI_COLORS.ACCENT),u=new p({text:`Room ${h}`,style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.SMALL),fill:o.UI_COLORS.TEXT,align:"center"}});u.anchor.set(.5),u.x=t/2,u.y=-this.layout.roomLabelOffset;const d=this.patronManager.getPatronInRoom(this.currentFloor,h),y=new p({text:d?d.name:"No one lives here right now",style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.SMALL),fill:d?o.UI_COLORS.SUCCESS:o.UI_COLORS.WARNING,align:"center"}});y.anchor.set(.5),y.x=t/2,y.y=e+this.layout.occupancyLabelOffset,a.addChild(c,r,u,y),a.x=i*(s+1)-t/2,a.y=this.layout.screenHeight/2-e/2,a.roomNumber=h,a.hasPatron=!!d,this.doors.push(a),this.container.addChild(a)}}createElevator(){const t=new f,e=this.layout.elevatorWidth,i=this.layout.elevatorHeight,s=new g().rect(0,0,e,i).fill(2899536),a=new g().circle(e/2,this.layout.elevatorUpButtonY,this.layout.elevatorButtonRadius).fill(this.currentFloor<this.patronManager.getFloorCount()?o.UI_COLORS.SUCCESS:o.UI_COLORS.WARNING),h=new g().circle(e/2,this.layout.elevatorDownButtonY,this.layout.elevatorButtonRadius).fill(this.currentFloor>1?o.UI_COLORS.SUCCESS:o.UI_COLORS.WARNING),c=new p({text:`Floor ${this.currentFloor}`,style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.UI),fill:o.UI_COLORS.TEXT,align:"center"}});c.anchor.set(.5),c.x=e/2,c.y=this.layout.elevatorFloorIndicatorY;const r=new p({text:"ELEVATOR",style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.SMALL),fill:o.UI_COLORS.TEXT,align:"center"}});r.anchor.set(.5),r.x=e/2,r.y=this.layout.elevatorLabelY,t.addChild(s,a,h,c,r),t.x=this.layout.screenWidth-e-this.layout.elevatorMargin,t.y=this.layout.screenHeight/2-i/2,this.elevatorButton=t,this.container.addChild(this.elevatorButton)}createUI(){this.uiContainer=new f;const t=new p({text:`Floor ${this.currentFloor} of ${this.patronManager.getFloorCount()}`,style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.UI),fill:o.UI_COLORS.TEXT,align:"left"}});t.x=this.layout.margin,t.y=this.layout.margin;const e=new g().rect(0,0,this.layout.hallwayControlsBackgroundWidth,this.layout.hallwayControlsBackgroundHeight).fill(0),i=new p({text:"Use ← → to move, SPACE to interact",style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.SMALL),fill:16777215,align:"left"}});e.x=this.layout.margin,e.y=this.layout.screenHeight-this.layout.margin-this.layout.hallwayControlsBackgroundHeight,i.x=this.layout.margin+this.layout.controlsBackgroundPadding,i.y=this.layout.screenHeight-this.layout.margin-i.height-this.layout.controlsBackgroundPadding,this.interactionPrompt=new p({text:"Press SPACE to interact",style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.UI),fill:o.UI_COLORS.ACCENT,align:"center",fontWeight:"bold"}}),this.interactionPrompt.anchor.set(.5),this.interactionPrompt.x=this.layout.centerX(),this.interactionPrompt.y=100*this.layout.scale,this.interactionPrompt.visible=!1,this.uiContainer.addChild(t,e,i,this.interactionPrompt),this.container.addChild(this.uiContainer)}positionPlayer(){if(this.returnFromRoom){const i=this.layout.screenWidth/(o.ROOMS_PER_FLOOR+1);this.playerPosition.x=i*this.returnFromRoom-this.layout.playerWidth/2}else this.playerPosition.x=this.layout.playerStartX;const t=this.layout.doorHeight,e=this.layout.screenHeight/2+t/2;this.playerPosition.y=e+this.layout.playerGroundOffset-this.layout.playerHeight,this.updatePlayerPosition()}updatePlayerPosition(){this.playerSprite.x=this.playerPosition.x,this.playerSprite.y=this.playerPosition.y}update(t){this.handleMovement(t),this.checkInteractions()}handleMovement(t){const e=this.playerSpeed*(t/60);this.isKeyPressed("ArrowLeft")&&(this.playerPosition.x=Math.max(this.layout.hallwaySideMargin,this.playerPosition.x-e)),this.isKeyPressed("ArrowRight")&&(this.playerPosition.x=Math.min(this.layout.screenWidth-this.layout.playerWidth-this.layout.hallwaySideMargin,this.playerPosition.x+e)),this.updatePlayerPosition()}checkInteractions(){const t=this.layout.interactionDistance;this.nearDoorIndex=-1;for(let i=0;i<this.doors.length;i++){const s=this.doors[i];if(Math.abs(this.playerPosition.x-s.x)<t){this.nearDoorIndex=i;break}}const e=Math.abs(this.playerPosition.x-this.elevatorButton.x);if(this.isNearElevator=e<t,this.nearDoorIndex>=0||this.isNearElevator)if(this.interactionPrompt.visible=!0,this.nearDoorIndex>=0){const s=this.doors[this.nearDoorIndex].hasPatron;this.interactionPrompt.text=s?"Press SPACE to enter room":"Room is empty"}else this.interactionPrompt.text="Press SPACE for elevator";else this.interactionPrompt.visible=!1}handleKeyDown(t){if(super.handleKeyDown(t),this.floorSelectionPopup){if(t==="Escape"){this.container.removeChild(this.floorSelectionPopup),this.floorSelectionPopup=null;return}if(t==="ArrowUp"){this.selectedFloorInPopup=Math.max(1,this.selectedFloorInPopup-1),this.updateFloorSelectionHighlight();return}if(t==="ArrowDown"){this.selectedFloorInPopup=Math.min(this.patronManager.getFloorCount(),this.selectedFloorInPopup+1),this.updateFloorSelectionHighlight();return}if(t==="Enter"){this.selectFloor(this.selectedFloorInPopup);return}const e=parseInt(t.replace("Digit",""));if(e>=1&&e<=this.patronManager.getFloorCount()){this.selectFloor(e);return}}t==="Space"&&this.handleInteraction()}async handleInteraction(){if(this.nearDoorIndex>=0){const t=this.doors[this.nearDoorIndex],e=t.roomNumber;t.hasPatron&&await this.enterRoom(e)}else this.isNearElevator&&await this.showElevatorMenu()}async enterRoom(t){const e=this.app.sceneManager;if(e){const{RoomScene:i}=await L(async()=>{const{RoomScene:c}=await import("./RoomScene-BB3RCdNY.js");return{RoomScene:c}},__vite__mapDeps([0,1]),import.meta.url),s=this.currentFloor,a=this.patronManager,h=class extends i{constructor(c){super(c),this.floor=s,this.roomNumber=t,this.patronManager=a}};await e.switchTo(h)}}async showElevatorMenu(){if(this.patronManager.getFloorCount()===1){this.showElevatorMessage("This elevator doesn't seem to go anywhere!");return}this.showFloorSelectionPopup()}showElevatorMessage(t){const e=new f,i=this.layout.screenWidth*.6,s=this.layout.screenHeight*.15,a=new g().roundRect(0,0,i,s,10).fill(0,.8).stroke({width:2,color:o.UI_COLORS.WARNING}),h=new p({text:t,style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.BODY),fill:o.UI_COLORS.WARNING,align:"center",fontWeight:"bold"}});h.anchor.set(.5),h.x=i/2,h.y=s/2,e.addChild(a,h),e.x=this.layout.centerX(i),e.y=this.layout.centerY(s),this.container.addChild(e),setTimeout(()=>{e.parent&&(this.container.removeChild(e),e.destroy())},2e3)}showFloorSelectionPopup(){const t=this.patronManager.getFloorCount();this.selectedFloorInPopup=this.currentFloor;const e=new f,i=new g().rect(0,0,this.layout.screenWidth,this.layout.screenHeight).fill(0,.7),s=300*this.layout.scale,a=200*this.layout.scale,h=new g().rect(0,0,s,a).fill(2899536).stroke({width:3,color:o.UI_COLORS.ACCENT});h.x=this.layout.centerX()-s/2,h.y=this.layout.centerY()-a/2;const c=new p({text:"Select Floor",style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.SUBTITLE),fill:o.UI_COLORS.TEXT,align:"center",fontWeight:"bold"}});c.anchor.set(.5),c.x=s/2,c.y=30*this.layout.scale;const r=new f,u=35*this.layout.scale,d=10*this.layout.scale,y=70*this.layout.scale;for(let O=1;O<=t;O++){const R=O===this.currentFloor,S=new g().rect(0,0,s-40*this.layout.scale,u).fill(R?o.UI_COLORS.WARNING:o.UI_COLORS.BUTTON);S.x=20*this.layout.scale,S.y=y+(O-1)*(u+d);const F=new p({text:R?`Floor ${O} (Current)`:`Floor ${O}`,style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.UI),fill:o.UI_COLORS.TEXT,align:"center"}});F.anchor.set(.5),F.x=S.width/2,F.y=S.height/2,S.addChild(F),r.addChild(S),S.floorNumber=O,S.isCurrentFloor=R,S.buttonText=F}const C=new p({text:"Use ↑↓ arrows, 1-"+t+", ENTER to select, ESC to cancel",style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.SMALL*.8),fill:o.UI_COLORS.SECONDARY,align:"center"}});C.anchor.set(.5),C.x=s/2,C.y=a-20*this.layout.scale,h.addChild(c,r,C),e.addChild(i,h),this.container.addChild(e),this.floorSelectionPopup=e,this.floorButtons=r,this.updateFloorSelectionHighlight()}updateFloorSelectionHighlight(){const t=this.floorButtons;if(t)for(let e=0;e<t.children.length;e++){const i=t.children[e],s=i.floorNumber,a=i.isCurrentFloor,h=s===this.selectedFloorInPopup;i.clear(),h?i.rect(0,0,i.width,i.height).fill(o.UI_COLORS.ACCENT):a?i.rect(0,0,i.width,i.height).fill(o.UI_COLORS.WARNING):i.rect(0,0,i.width,i.height).fill(o.UI_COLORS.BUTTON)}}selectFloor(t){this.floorSelectionPopup&&(this.container.removeChild(this.floorSelectionPopup),this.floorSelectionPopup=null),t!==this.currentFloor&&this.goToFloor(t)}async goToFloor(t){const e=this.app.sceneManager;if(e){const i=class extends E{constructor(s){super(s),this.currentFloor=t}};await e.switchTo(i)}}onResize(){this.playerSpeed=this.layout.playerSpeed,this.container.removeChildren(),this.createBackground(o.PLACEHOLDER_COLORS.FLOOR),this.createHallwayLayout(),this.createPlayer(),this.createDoors(),this.createElevator(),this.createUI(),this.positionPlayer()}}const Y=Object.freeze(Object.defineProperty({__proto__:null,HallwayScene:E},Symbol.toStringTag,{value:"Module"}));class U extends w{constructor(t){super(t);l(this,"transitionText");l(this,"fadeOverlay");l(this,"phase","fadeIn");l(this,"phaseTimer",0);l(this,"DISPLAY_DURATION",2e3)}async enter(){this.createBackground(0),this.createFadeOverlay(),this.createTransitionText()}createTransitionText(){this.transitionText=new p({text:"Now entering the workshop!",style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.TITLE),fill:o.UI_COLORS.TEXT,align:"center",fontWeight:"bold"}}),this.transitionText.anchor.set(.5),this.transitionText.x=this.layout.centerX(),this.transitionText.y=this.layout.centerY(),this.transitionText.alpha=0,this.container.addChild(this.transitionText)}createFadeOverlay(){this.fadeOverlay=new g().rect(0,0,this.layout.screenWidth,this.layout.screenHeight).fill(0),this.fadeOverlay.alpha=0,this.container.addChild(this.fadeOverlay)}update(t){const e=t*16.67;switch(this.phaseTimer+=e,this.phase){case"fadeIn":this.updateFadeIn(e);break;case"display":this.updateDisplay();break;case"fadeOut":this.updateFadeOut(e);break}}updateFadeIn(t){const e=this.phaseTimer/o.FADE_DURATION;this.transitionText.alpha=Math.min(e,1),e>=1&&(this.phase="display",this.phaseTimer=0)}updateDisplay(){this.phaseTimer>=this.DISPLAY_DURATION&&(this.phase="fadeOut",this.phaseTimer=0)}updateFadeOut(t){const e=this.phaseTimer/o.FADE_DURATION;this.transitionText.alpha=Math.max(1-e,0),e>=1&&this.transitionToHallway()}async transitionToHallway(){const t=this.app.sceneManager;t&&await t.switchTo(E)}onResize(){this.container.removeChildren(),this.createBackground(0),this.createFadeOverlay(),this.createTransitionText()}handleKeyDown(t){switch(super.handleKeyDown(t),t){case"Space":case"Enter":case"Escape":this.transitionToHallway();break}}}class N extends w{constructor(t){super(t);l(this,"startButton");l(this,"aboutButton")}async enter(){this.createBackground(o.BACKGROUND_COLOR),this.createTitle(),this.createButtons(),this.setupInteractivity()}createTitle(){const t=new p({text:"Visit the Workshop!",style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.TITLE),fill:o.UI_COLORS.TEXT,align:"center",fontWeight:"bold"}});t.anchor.set(.5),t.x=this.layout.centerX(),t.y=this.layout.screenHeight*.3;const e=new p({text:"Interactive Credits & Patron Showcase",style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.SUBTITLE),fill:o.UI_COLORS.SECONDARY,align:"center"}});e.anchor.set(.5),e.x=this.layout.centerX(),e.y=t.y+this.layout.getFontSize(80),this.container.addChild(t,e)}createButtons(){const t=this.layout.screenHeight*.65,e=this.layout.getFontSize(200),i=this.layout.centerX();this.startButton=this.createButton("START",i-e/2,t,()=>this.switchToTransition()),this.aboutButton=this.createButton("ABOUT",i+e/2,t,()=>this.switchToAbout()),this.container.addChild(this.startButton,this.aboutButton)}createButton(t,e,i,s){const a=new f,h=this.layout.getButtonSize(),c=new g().roundRect(0,0,h.width,h.height,10).fill(o.UI_COLORS.BUTTON),r=new p({text:t,style:{fontFamily:o.DEFAULT_FONT_FAMILY,fontSize:this.layout.getFontSize(o.FONT_SIZES.UI),fill:o.UI_COLORS.TEXT,align:"center",fontWeight:"bold"}});return r.anchor.set(.5),r.x=h.width/2,r.y=h.height/2,a.addChild(c,r),a.x=e-h.width/2,a.y=i-h.height/2,a.eventMode="static",a.cursor="pointer",a.background=c,a.text=r,a.onClick=s,a}setupInteractivity(){this.startButton.on("pointerenter",()=>{this.updateButtonAppearance(this.startButton,!0)}),this.startButton.on("pointerleave",()=>{this.updateButtonAppearance(this.startButton,!1)}),this.startButton.on("pointerdown",()=>{this.startButton.onClick()}),this.aboutButton.on("pointerenter",()=>{this.updateButtonAppearance(this.aboutButton,!0)}),this.aboutButton.on("pointerleave",()=>{this.updateButtonAppearance(this.aboutButton,!1)}),this.aboutButton.on("pointerdown",()=>{this.aboutButton.onClick()})}updateButtonAppearance(t,e){const i=t.background,s=e?o.UI_COLORS.BUTTON_HOVER:o.UI_COLORS.BUTTON,a=this.layout.getButtonSize();i.clear(),i.roundRect(0,0,a.width,a.height,10).fill(s)}onResize(){this.container.removeChildren(),this.createBackground(o.BACKGROUND_COLOR),this.createTitle(),this.createButtons(),this.setupInteractivity()}handleKeyDown(t){switch(super.handleKeyDown(t),t){case"Enter":case"Space":this.switchToTransition();break}}async switchToTransition(){const t=this.app.sceneManager;t&&await t.switchTo(U)}async switchToAbout(){const t=this.app.sceneManager;t&&await t.switchTo(B)}}const v=Object.freeze(Object.defineProperty({__proto__:null,StartScene:N},Symbol.toStringTag,{value:"Module"}));class W{constructor(){l(this,"app");l(this,"sceneManager");this.app=new P,this.sceneManager=new D(this.app)}async initialize(){try{const n=I.getInstance();await this.app.init({width:n.screenWidth,height:n.screenHeight,backgroundColor:1710638,antialias:!0,resolution:window.devicePixelRatio||1,autoDensity:!0});const t=document.getElementById("gameContainer");t?t.appendChild(this.app.canvas):document.body.appendChild(this.app.canvas),this.setupResizeHandler(n),this.setupKeyboardControls(),this.sceneManager.setupUpdateLoop(),this.app.sceneManager=this.sceneManager,await this.sceneManager.switchTo(N)}catch(n){}}setupResizeHandler(n){n.onResize(t=>{this.app.renderer.resize(t.screenWidth,t.screenHeight);const e=this.sceneManager.getCurrentScene();e&&e.onResize&&e.onResize(t)})}setupKeyboardControls(){document.addEventListener("keydown",n=>{this.sceneManager.handleKeyDown(n.code)}),document.addEventListener("keyup",n=>{this.sceneManager.handleKeyUp(n.code)})}}async function _(){await new W().initialize()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",_):_();export{w as B,o as G,Y as H};
//# sourceMappingURL=index-D_ALOtkQ.js.map
